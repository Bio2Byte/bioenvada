import sys



#tree = sys.argv[1]
#tree = '(1001_groEL2_2_C_M_methanotrophicum:1.2404702047,(2684623155_groEL2_2_M_simiae:0.7543848030,((2506783060_groEL2_2_M_sp__JS623:0.3743138673,2651869738_groEL2_1_M_goodii:0.4552234411)94:0.1979397410,(2772190606_groEL2_1_M_sp__djl_10:0.2452126520,2772190610_groEL2_1_M_sp__MS1601:0.2609574343)100:0.2149161635)97:0.3524362101)100:0.7387611977,((2001_HSPD1_human_rna_1:1.9076414278,9999_groL_E_coli:1.0218464078)100:0.9474264921,(((((((((((((2808606681_groEL2_M_senegalense:0.0518527616,(((2925677529_groEL2_M_sp__DL440:0.0704124068,2619619212_groEL2_M_vulneris:0.0500337094)84:0.0428228065,((2687453205_groEL2_M_sp__QIA_37:0.0573496730,2775507227_groEL2__M__stephanolepid:0.0647730102)100:0.1220335650,2687453194_groEL2_M_sp__YC_RL4:0.0936083138)98:0.0573496730)79:0.0464152673,2772190613_groEL2_3_M_dioxanotrophi:0.0428228065)73:0.0183801270)75:0.0321985432,((2772190610_groEL2_2_M_sp__MS1601:0.0896696720,2772190606_groEL2_2_M_sp__djl_10:0.1056046058)88:0.0321985432,((2708742393_groEL2_M_sp__WY10:0.0666458991,2651869802_groEL2_M_sp__EPa45:0.0838169151)100:0.0666458991,2897245179_groEL2_M_sp__DL592:0.1056046058)99:0.0536784156)92:0.0446158067)91:0.0321985432,2540341250_groEL2_M_sp__141:0.0610477727)99:0.0685256853,(2838237436_groEL2_M_sp__OAE906:0.1117063498,(2506783060_groEL2_1_M_sp__JS623:0.0647730102,(2838259578_groEL2_M_sp__OAS707:0.0099385095,2852593896_groEL2_M_sp__OAE908:0.0082677397)100:0.0482212231)100:0.0761145699)100:0.0799514015)99:0.0818805530,2962349434_groEL2_M_novum:0.1262206991)92:0.0591953491,((((2684623155_groEL2_1_M_simiae:0.0838169151,(2775507225_groEL2_M_shigaense:0.0016421654,2913062581_groEL2_M_shigaense:0.0016421654)100:0.1096646436)61:0.0374822213,(2862917077_groEL2_M_numidiamassilie:0.0666458991,2862938823_groEL2_M_rhizamassiliens:0.0704124068)76:0.0252406002)48:0.0217983083,(2684622521_groEL2_M_lentiflavum:0.0269708674,2802429209_groEL2_M_ahvazicum:0.0392560481)100:0.0410362317)54:0.0304498062,(2923207141_groEL2_M_paragordonae:0.0464152673,2930226548_groEL2_M_gordonae:0.0536784156)100:0.0518527616)51:0.0287072586)54:0.0252406002,(((((2563366549_groEL2_M_liflandii:0.0016421654,2602041573_groEL2_M_sp__012931:0.0049435111)89:0.0016421654,(2806310722_groEL2_M_ulcerans:0.0049435111,2908528759_groEL2_M_ulcerans:0.0049435111)51:0.0016421654)93:0.0016421654,(2541047508_groEL2_M_marinum:0.0016421654,2875591110_groEL2_M_marinum:0.0016421654)100:0.0049435111)69:0.0016421654,2545824679_groEL2_M_marinum:0.0016421654)100:0.0742068102,2875597469_groEL2_M_basiliense:0.0896696720)90:0.0357147173)59:0.0287072586,(((((((2917256612_groEL2_M_avium:0.0016421654,2872603604_groEL2_M_avium:0.0032899927)99:0.0032899927,2965840331_groEL2_M_avium:0.0016421654)91:0.0016421654,2897239886_groEL2_M_avium:0.0016421654)88:0.0032899927,2875571111_groEL2_M_avium:0.0016421654)99:0.0066027502,(2917251876_groEL2_M_avium:0.0032899927,2775507226_groEL2_M_lepraemurium:0.0464152673)39:0.0016421654)81:0.0016421654,(2875562037_groEL2_M_avium:0.0049435111,(2909106351_groEL2_M_avium:0.0016421654,2718217934_groEL2_M_avium:0.0016421654)100:0.0032899927)100:0.0066027502)100:0.0518527616,((2856544576_groEL2_M_intracellulare:0.0166799988,(((((2630968346_groEL2_M_intracellulare:0.0016421654,2856551076_groEL2_M_intracellulare:0.0016421654)59:0.0016421654,2917261365_groEL2_M_intracellulare:0.0032899927)81:0.0016421654,2969191417_groEL2_M_intracellulare:0.0032899927)48:0.0016421654,(2531839247_groEL2_M_sp__H4Y:0.0132975112,2521172703_groEL2_M_intracellulare:0.0032899927)76:0.0032899927)90:0.0082677397,2773858027_groEL2_M_intracellulare:0.0082677397)52:0.0049435111)100:0.0217983083,2775507224_groEL2_M_marseillense:0.0235164245)100:0.0482212231)100:0.0464152673)94:0.0410362317,1001_groEL2_1_C_M_methanotrophicum:0.1015754378)94:0.0410362317,(((((((((((2877840930_groEL2_M_tuberculosis:0.0016421654,2917247656_groEL2_M_tuberculosis:0.0016421654)58:0.0016421654,2545824630_groEL2_M_tuberculosis:0.0016421654)35:0.0016421654,(2619619356_groEL2_M_tuberculosis:0.0016421654,(((2969213687_groEL2_M_tuberculosis:0.0016421654,2684623049_groEL2_1_M_tuberculosis:0.0082677397)35:0.0016421654,2645727796_groEL2_M_tuberculosis:0.0016421654)15:0.0016421654,2684623220_groEL2_M_tuberculosis:0.0016421654)53:0.0016421654)64:0.0016421654)33:0.0016421654,2545824629_groEL2_M_tuberculosis:0.0032899927)34:0.0016421654,((2917213916_groEL2_M_tuberculosis:0.0016421654,2540341146_groEL2_M_tuberculosis:0.0016421654)27:0.0016421654,(2687453574_groEL2_M_tuberculosis:0.0016421654,2870396880_groEL2_M_tuberculosis:0.0032899927)46:0.0016421654)25:0.0016421654)93:0.0032899927,2541047045_groEL2_M_canettii:0.0016421654)49:0.0016421654,2541047047_groEL2_M_canettii:0.0016421654)95:0.0066027502,2540341073_groEL2_M_canettii:0.0116150899)100:0.0217983083,2541047046_groEL2_M_canettii:0.0217983083)100:0.1676857254,1000_groEL2_C_M_methanotrophicum:0.1454731554)88:0.0392560481,2897227913_groEL2_M_kansasii:0.1304405397)96:0.0573496730)99:0.0780294204,2645727719_groEL2_M_haemophilum:0.0799514015)99:0.1262206991,2860163127_groEL2_M_leprae:0.2298706486)100:0.5109943789,(2772190613_groEL2_1_M_dioxanotrophi:0.3050376620,2772190613_groEL2_2_M_dioxanotrophi:0.2771210678)100:0.6838398704)100:0.5071393657)100:0.5630260812);'
tree = '(9999_groL_E_coli|157:0.278702,((1000_groEL1_C_M_methanotrophicum|0:0.228113,((((((2645727719_groEL1_M_haemophilum|24:0.0430628,2860163127_groEL1_M_leprae|70:0.229105)Node13|71:0.219755,(((2862938823_groEL1_M_rhizamassiliens|74:0.210282,2913062581_groEL1_M_shigaense|98:0.153039)Node16|99:0.0411406,(2684622521_groEL1_M_lentiflavum|27:0.162918,2862917077_groEL1_M_numidiamassilie|72:0.204922)Node17|73:0.0900173)Node15|100:0.0328324,(2802429209_groEL1_M_ahvazicum|53:0.162557,2684623155_groEL1_M_simiae|28:0.215594)Node18|54:0.0505645)Node14|101:0.0388676)Node12|102:0.069715,(((((((2721755526_groEL1_M_intracellulare|37:0.0158952,(2521172703_groEL1_M_intracellulare|10:2.5724e-06,(2856574078_groEL1_M_intracellulare|66:3.0756e-06,2531839247_groEL1_M_sp__H4Y|11:0.00387516)Node27|67:0.00193498)Node26|68:0.00318636)Node25|69:0.00982525,((2519103109_groEL1_M_intracellulare|8:0.0108734,2512564050_groEL1_M_intracellulare|4:3.0071e-06)Node29|9:0.00589942,2917261365_groEL1_M_intracellulare|105:0.00978789)Node28|106:0.010775)Node24|107:0.0147913,(2518645550_groEL1_M_sp__MOTT36Y|7:0.00852554,2772190781_groEL1_M_intracellulare|43:0.00859067)Node30|44:0.0130513)Node23|108:0.0169977,2541047007_groEL1_M_intracellulare|15:0.0256013)Node22|109:0.0303293,2775507224_groEL1_M_marseillense|48:0.0615707)Node21|110:0.0991875,(((((2872603604_groEL1_M_avium|75:0.0113447,2627853683_groEL1_M_avium|23:0.00440349)Node35|76:2.6399e-06,(2965840331_groEL1_M_avium|133:0.00484547,2877853518_groEL1_M_avium|82:0.00403663)Node36|134:0.00525038)Node34|135:0.0125176,((2875602454_groEL1_M_avium|79:2.5667e-06,2875562037_groEL1_M_avium|77:0.00194275)Node38|80:0.00771899,2897239886_groEL1_M_avium|84:0.0151203)Node37|85:0.00780773)Node33|136:0.0031946,(2909111051_groEL1_M_avium|97:2.8557e-06,2917251876_groEL1_M_avium|103:2.8483e-06)Node39|104:0.006512)Node32|137:0.00537622,2775507226_groEL1_M_lepraemurium|49:0.043995)Node31|138:0.150847)Node20|139:0.109373,1001_groEL1_C_M_methanotrophicum|1:0.269385)Node19|140:0.0414765)Node11|141:0.0364288,(2923207141_groEL1_M_paragordonae|112:0.11949,2930226548_groEL1_M_gordonae|126:0.174707)Node40|127:0.231455)Node10|142:0.0273938,((2897233925_groEL1_M_kansasii|83:0.249711,(2875597469_groEL1_M_basiliense|78:0.242281,((((2806310722_groEL1_M_ulcerans|55:0.00407761,2541047508_groEL1_M_marinum|19:0.010815)Node47|56:3.0413e-06,2908528759_groEL1_M_ulcerans|89:0.00907322)Node46|90:2.6162e-06,(2909077730_groEL1_M_pseudoshottsii|91:0.00203883,2563366549_groEL1_M_liflandii|21:2.5551e-06)Node48|92:3.3965e-06)Node45|93:0.00995824,2545824679_groEL1_M_marinum|20:2.4252e-06)Node44|94:0.197013)Node43|95:0.0712453)Node42|96:0.0889017,(((((((2718218324_groEL1_M_tuberculosis|36:0.00390718,(2962370750_groEL1_M_tuberculosis|132:0.00202007,2969187188_groEL1_M_tuberculosis|143:0.00202228)Node56|144:3.048e-06)Node55|145:2.6203e-06,(((((2695420338_groEL1_M_tuberculosis|32:2.5551e-06,((2925692285_groEL1_M_tuberculosis|119:0.00202301,2923172835_groEL1_M_tuberculosis|111:0.00202167)Node63|120:3.5516e-06,2877836738_groEL1_M_tuberculosis|81:0.0020201)Node62|121:3.5365e-06)Node61|122:2.9307e-06,2718217865_groEL1_M_tuberculosis|34:0.00202076)Node60|123:3.0745e-06,2687453574_groEL1_M_tuberculosis|31:0.00607051)Node59|124:3.4267e-06,2718218048_groEL1_M_tuberculosis|35:0.00202014)Node58|125:3.5277e-06,2938936827_groEL1_M_tuberculosis|128:0.00202055)Node57|129:2.7308e-06)Node54|146:2.4849e-06,2512564073_groEL1_2_M_tuberculosis|5:0.00501846)Node53|147:0.00202128,2541047047_groEL1_M_canettii|18:0.00201771)Node52|148:0.00197157,2541047045_groEL1_M_canettii|16:0.014299)Node51|149:0.00978277,2541047046_groEL1_M_canettii|17:0.0208505)Node50|150:0.029,2540341073_groEL1_M_canettii|12:0.0164985)Node49|151:0.344348)Node41|152:0.0502138)Node9|153:0.129133,(2962349434_groEL1_M_novum|130:0.378936,((((2772190610_groEL1_M_sp__MS1601|39:0.141344,2772190606_groEL1_M_sp__djl_10|38:0.118809)Node68|40:0.155277,(2687453205_groEL1_M_sp__QIA_37|30:0.0595969,2775507227_groEL1__M__stephanolepid|50:0.0565288)Node69|51:0.436549)Node67|52:0.0621489,((2651869802_groEL1_M_sp__EPa45|26:0.128943,(2775507218_groEL1_M_sp__PYR15|45:0.0117163,2708742393_groEL1_M_sp__WY10|33:0.00960478)Node72|46:0.09168)Node71|47:0.149646,2897245179_groEL1_M_sp__DL592|86:0.239802)Node70|87:0.10381)Node66|88:0.0559379,(((((2852593896_groEL1_M_sp__OAE908|61:0.0143871,2838259578_groEL1_M_sp__OAS707|60:0.0163439)Node76|62:0.155811,2506783060_groEL1_M_sp__JS623|3:0.137377)Node75|63:0.137974,2838237436_groEL1_M_sp__OAE906|59:0.27419)Node74|64:0.106707,2687453194_groEL1_M_sp__YC_RL4|29:0.320735)Node73|65:0.0613798,(2651869738_groEL1_M_goodii|25:0.286018,((2925677529_groEL1_M_sp__DL440|113:0.123163,(2808606681_groEL1_M_senegalense|57:0.0908205,2619619212_groEL1_M_vulneris|22:0.0582766)Node78|58:0.0588131)Node77|114:0.111024,(2772190613_groEL1_M_dioxanotrophicu|41:0.0989075,(2516493018_groEL1_M_sp__155|6:0.0565666,2540341250_groEL1_M_sp__141|13:0.045752)Node1|14:0.108117)Node2|42:0.0973877)Node3|115:0.032649)Node4|116:0.0384105)Node5|117:0.0650703)Node6|118:0.0919571)Node7|131:0.0785283)Node8|154:0.157252)Node64|155:1.95745,2001_HSPD1_human_rna_1|2:2.34976)Node65|156:0.278702);'



tree = tree.split(',')

ntree = ''
for elem in tree:
    elem = elem.split('_')
    if '(' in elem[0]:
        e1 = elem[0].split('(')
        e1 = e1[:-1]
        ne1 =''
        for n  in e1:
            ne1 = ne1 + '('
        sname = ne1
    else:
        sname = ""
    
    rest = elem[2:]
    for e in rest:
        sname =sname + e+ '_' 

    ntree = ntree + sname[:-1] + ','

ntree = ntree [:-1]
ntree = ntree.replace ("__","_")

print (ntree)